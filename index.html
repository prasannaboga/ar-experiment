<html>
  <head>
    <title>My first three.js app</title>
    <style>
      body {
        margin: 0;
      }

      canvas {
        width:  100%;
        height: 100%
      }
    </style>
  </head>
  <body>
    <script src="artoolkit.debug.js"></script>
    <script src="artoolkit.api.js"></script>
    <script src="three.min.js"></script>
    <script src="artoolkit.three.js"></script>
    <script>
      var loader = new THREE.FontLoader();

      loader.load('droid_sans_mono_regular.typeface.json', function (font) {
        var scene  = new THREE.Scene();
        var camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);

        var renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        var geometry = new THREE.TextGeometry('AR', {
          font:   font,
          size:   10,
          height: 2
        });
        var material = new THREE.MeshBasicMaterial({color: 0xffa500});
        var cube     = new THREE.Mesh(geometry, material);

        scene.add(cube);

        camera.position.z = 80;

        var render = function () {
          requestAnimationFrame(render);

          cube.rotation.y += 0.1;

          renderer.render(scene, camera);
        };

        render();

        ARController.getUserMediaThreeScene({
          maxARVideoSize: 320,
          cameraParam: 'camera_para.dat',
          onSuccess: function(arScene, arController, arCamera) {
            document.body.className = arController.orientation;

            arController.setPatternDetectionMode(artoolkit.AR_MATRIX_CODE_DETECTION);

            var renderer = new THREE.WebGLRenderer({antialias: true});
            if (arController.orientation === 'portrait') {
              var w = (window.innerWidth / arController.videoHeight) * arController.videoWidth;
              var h = window.innerWidth;
              renderer.setSize(w, h);
              renderer.domElement.style.paddingBottom = (w-h) + 'px';
            } else {
              if (/Android|mobile|iPad|iPhone/i.test(navigator.userAgent)) {
                renderer.setSize(window.innerWidth, (window.innerWidth / arController.videoWidth) * arController.videoHeight);
              } else {
                renderer.setSize(arController.videoWidth, arController.videoHeight);
                document.body.className += ' desktop';
              }
            }
            document.body.insertBefore(renderer.domElement, document.body.firstChild);

            var markerRoot = arController.createThreeBarcodeMarker(20);
            var sphere = new THREE.Mesh(
              new THREE.SphereGeometry(0.5, 8, 8),
              new THREE.MeshNormalMaterial()
            );
            sphere.material.shading = THREE.FlatShading;
            sphere.position.z = 0.5;
            markerRoot.add(sphere);
            arScene.scene.add(markerRoot);
            var rotationV = 0;
            var rotationTarget = 0;
            renderer.domElement.addEventListener('click', function(ev) {
              ev.preventDefault();
              rotationTarget += 1;
            }, false);
            var tick = function() {
              arScene.process();
              arScene.renderOn(renderer);
              rotationV += (rotationTarget - sphere.rotation.z) * 0.05;
              sphere.rotation.z += rotationV;
              rotationV *= 0.8;
              requestAnimationFrame(tick);
            };
            tick();
          }});
      });
    </script>
  </body>
</html>
